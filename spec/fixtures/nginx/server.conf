# the server directive is nginx's virtual host directive.
server {
  # port to listen on. Can also be set to an IP:PORT
  listen 80;

  # Set the max size for file uploads to 50Mb
  client_max_body_size 50M;

  # sets the domain[s] that this vhost server requests for
  server_name application.tld *.application.tld;

  # doc root
  root /home/application/current/public;

  # vhost specific access log
  access_log  /var/log/nginx.application.access.log  main;
  error_log  /var/log/nginx.application.access.log  notice;

  # this rewrites all the requests to the maintenance.html
  # page if it exists in the doc root. This is for capistrano's
  # disable web task
  if (-f $document_root/system/maintenance.html) {
    rewrite  ^(.*)$  /system/maintenance.html last;
    break;
  }

  error_page   500 502 503 504  /500.html;
  location = /500.html {
    root   /home/application/current/public;
  }
}
